All files needed for the Momentum into Allegro integration can be found in 
the directory %HPEESOF_DIR%/ial or $HPEESOF_DIR/ial. this is the directory where
this INSTALL file normaly resides. 

HPEESOF_DIR is an environment variable that points the head of the ADS 
installation tree. Or the directory where ial directory is copied.

On machines without ADS you need to copy the entire ial directory to this machine. 
With Allegro 16.00 or higher the machine will also require Python 2.5, 2.6 or 2.7 to have the ADFI working.

To install the Momentum export in a personal configuration for Allegro

1) Inside Allegro goto File->Script to open the scripting tool and browse 
for the file $HPEESOF_DIR/ial/scripts/eemLocalConfig.scr.

Note: make sure you enable the Change Directory flag in the Allegro file browser.

2) Replay the configuration script.

To install the Momentum export interface into in a site configuration for Allegro

1) Prepare the load of the eemAdfiSetup.il from site level

   a) Modify the Allegro initialization file eemAdfiSetup.il generated by the replay of the eemLocalConfig.scr 
      to load the Momentum integration context file and set the parameters needed for a generic load at the site.
      
      This file resides in your $HOME/pcbenv (Unix) or %HOME%\pcbenv or %HOMEDRIVE%\%HOMEPATH%\pcbenv (Windows) directory.
      
      Or start from the eemAdfiSetup.il template below and update according to your needs.

;; ----------------------------------------------------
;; --- BEGIN ADFI Keysight EEsof EDA ADFI config
;; --- Modified: <date of creation>

;; Place or remove or the comment character (;) in front
;; and modify values if you want to change the ADS Allegro DFI load behavior.

;; enable/disable automatic menu load OFF or ON (default)
;(setShellEnvVar "EEMOM_MENU_AUTOLOAD=ON") 

;; if automatic menu load is OFF you manually have to add menu fragment
;; $HPEESOF_DIR/ial/config/eemMenuFrag.men to all the 
;; menu files you want in < allegro_install_path >/share/local/pcb/menus
;; and store the updated .men files in the appropriate menu location

;; menu string to search for when adding menu fragment
;(axlSetVariable "Eem_Menu_ItemPosition" "&Help") 

;; position before or after the named item nil|t
;(axlSetVariable "Eem_Menu_AfterItem" nil)

;; add the Start ADS menu item
;(axlSetVariable "Eem_Menu_HasStartAds" 1)

;; IMPORTANT 
;; !!! Independent of the platform Windows and Unix always !!!
;; !!! use / as the directory delimiter in this file       !!!
;; !!! And avoid directories with spaces in the name       !!!

;; specify the ADS installation directory if you want integration
(setShellEnvVar "HPEESOF_DIR=C:/ADS2009U1")

;; Probably best to always enable the license settings to avoid not found issues from within Allegro
;; Note that additional preference settings for licensing can be required.
;; ADS 2009 Update 1 and earlier
;(setShellEnvVar "AGILEESOFD_LICENSE_FILE=")
;; ADS 2011.01 and later
;(setShellEnvVar "ADS_LICENSE_FILE=")

;; If no ADS installation is available a Python installation 2.5.x or 2.6.x must be specified
;(setShellEnvVar "EEMOM_PYTHON=C:/Python26/python.exe")

;; Define the EEMOM_SKILL_DIR only in a user's local configurations not at site level
;; to keep the overloading capabilities for personal setups available.
;(setShellEnvVar "EEMOM_SKILL_DIR=<full path to ial install directory>/ial/skill/15.7")

;; Specify a site specific eemom.option file instead of the default under
;; <full path to ial install directory>/ial/config/eemom.option
;; note : the contents of the optional files $HOME/pcbenv/eemom.option and 
;;        <currentWorkingDir>/<currentDesign>.option will be added to the list
;(setShellEnvVar "EEMOM_GLOBALOPTIONSFILE=<pathToWhereItResides>/eemom.option")}}

(load "<full path to ial install directory>/ial/skill/15.7/eemom.ini")

;; --- END ADFI Keysight EEsof EDA ADFI config
;; ----------------------------------------------------

   b) Goto the your site's skill configuration directory which can reside in the following locations
        <cdsroot>/share/pcb/etc/skill (or a user-defined location specified by CDS_SITE) 
        $ALLEGRO_SITE/skill 
        ~/pcbenv 
        . (the program's start directory) 

      An allegro.ilinit or any other tool specific ilinit (like apd.ilinit or cdnsip.ilinit) file residing in any of these directories will be loaded in above order
      Copy the updated eemAdfiSetup.il initialisation file in the directory you want.

   b) Open the file allegro.ilinit or <tool>.ilinit that you want ot use with the editor of your choise
       - Create the file if it does not exist already in the correct location -

   c) Add the following line to one of each of the ilinit files that you want the Allegro DFI to be available in
      (load "<path to the your site specific eemAdfiSetup.il>") ; Keysight EEsof EDA, Allegro ADFI load

2) Adding the Export to ADS menu items to all Allegro tools menu files

   This step is optional with EEMOM_MENU_AUTOLOAD=ON
   the automatic load mechanism will check for the existence of 
   required menu fragments if it finds a manual configuration it skips the load
   otherwise the menu section is automatically added about 1 second
   after the Help item becomes available in the Allegro menu.
   
   This step is required if you have set EEMOM_MENU_AUTOLOAD=OFF
   to disable the automatic menu load mechanism as this is 
   the only way to access the Allegro DFI functionality otherwise.

   An example for a popup menu to be added to the Allegro menufile is 
   provided in the file 
      $HPEESOF_DIR/ial/config/eemMenuFrag.men
      
   For configurations with specific menu setup requirements you need to
   modify the Allegro menufile and insert this fragment in each of the menu files
   of the various tools.


Notes: 
    * the location <allegro_install_path>/share/local/pcb/menus used below 
      can be changed to any directory by either 
      + modifying the MENUPATH allegro variable to include the new directory
      + using the Allegro UI -> Setup -> User Preferences ... 
        and add the directory where the menufile resides to Ui_paths menupath
      + adding the following line to your allegro.ilinit file 
        - see below for more info on how to modify allegro.ilinit -
        (setShellEnvVar "EEMOM_MENUPATH=<directoryWhereMenufileResides>")
        In this case, if a menufile resides in the working directory, and the 
        working directory is first in Allegro's MENUPATH, then that file will 
        be used. 
   
   a) Copy the <allegro_install_path>/share/pcb/text/cuimenus/allgro.men 
      - or the menufile you currently are using - to 
     <allegro_install_path>/share/local/pcb/menus

   b) open the file in a text editor

   c) Add the content of $HPEESOF_DIR/ial/config/eemMenuFrag.men to this 
      file just before the POPUP "&Help"

   d) save the file.


3) Open the Allegro PCB editor, the Momentum menu entry should be visible 
   in the menubar at the top

   If not check and modify the allegro configuration and modify the ui menu 
   path to make sure that the place where your updated allegro.men file is 
   stored is in front of the path.

   You get there through:
      Setup->User Preference->Ui paths push on the menu path button.


Enable the Allegro import interface into ADS by loading the 
import design kit residing in  
$HPEESOF_DIR/ial/design_kit/import_allegro_<VERSION>_dk.zip 
into ADS as an ADS design kit.
